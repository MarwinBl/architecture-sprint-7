# Описание взаимодействия сервисов обеспечивающих новый функционал умного дома.

## Приложение пользователя

Так как партнер предоставляет нам сервисы для умного дома и его технологии, 
то за работу по снятию биометрии клиента и ее передаче в хранилище партнера отвечает его плагин, 
который мы встраиваем в приложение. 
При инициализации плагина мы передаем в него наш идентификатор клиента для его будущего использования партнером 
и токен аутентификации сгенеренный нами.
В приложение также добавляется функционал для работы с умным домом.

## Партнер

Взаимодействует с сервисом умного дома через REST API, 
передавая в него запросы пользователя к умным устройствам (например использование домофона).
Может получить как успешный ответ, так и ошибку об отсутствии прав у пользователя на выполнение действия.
При получении биометрии от пользователя с нашим токеном аутентификации - 
партнер проверяет в нашем сервисе умного дома валидность токена и соответствие его идентификатору пользователя.
Для авторизации в сервисе умного дома используется Basic Auth.


## Сервис умного дома

Взаимодействует с партнером через REST API, отправляя запросы пользователя к умным устройствам.
Для авторизации в сервисе партнера используется Basic Auth.


### Требования к безопасности:
- Все данные, передаваемые между приложением, плагином и партнёром, должны быть зашифрованы с использованием HTTPS/TLS.
- Передаваемые данные должны быть подписаны цифровой подписью для обеспечения целостности и подлинности.
- Токены аутентификации должны быть обновляемыми при каждой инициализации плагина и иметь срок жизни не более суток.
- Ключи
- Биометрические данные должны храниться только на стороне партнёра и не должны сохраняться в приложении или на сервере компании.
- Идентификаторы клиентов должны быть уникальными и не содержать личной информации.
- Вести журнал всех запросов и ответов между системами для аудита и мониторинга.
- Обеспечить мониторинг безопасности для выявления и предотвращения подозрительных действий.
- Хранение ключей и сертификатов должно быть защищено от несанкционированного доступа.


### Протоколы аутентификации и авторизации:
1) Плагин приложения аутентифицируется в партнере с помощью токена аутентификации, 
подлинность которого партнер удостоверяет в сервисе умного дома.
2) Авторизация между партнером и сервисом умного дома происходит с помощью Basic Auth. 
Данные для авторизации ротируются в соответствии с политиками организаций. 
Выдаваемые сервисом умного дома партнеру данные авторизации имеют срок жизни 30 дней.